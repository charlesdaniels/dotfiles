ST_SRC="$THIRDPARTY_DIR/st"
ST_STATIC="$ST_SRC/staticbin/st-$(uname)"

rm -f "$HOME/bin/st"

printf "INFO: building st... "
make -C "$ST_SRC" clean > "$LOG_DIR/st.log" 2>&1
make -C "$ST_SRC" st >> "$LOG_DIR/st.log" 2>&1
if [ ! -x "$ST_SRC/st" ] ; then
	echo "FAIL"
	printf "INFO: failing over to prebuilt st... "
	if [ ! -x "$ST_STATIC" ] ; then
		echo "FAIL"
	else
		ln -s "$ST_STATIC" "$HOME/bin/st"
		echo "DONE"
	fi
else
	ln -s "$ST_SRC/st" "$HOME/bin/st"
	echo "DONE"
fi
