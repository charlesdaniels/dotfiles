#!/bin/sh

# lock the screen using i3lock

for pn in convert scrot uuidgen ; do
	if [ ! -x "$(which $pn)" ] ; then
		echo "$pn not found, failing over to wallpaper lock"
		i3lock -i ~/.wallpapers/current
		exit
	fi
done

TMPFILE="/tmp/$(uuidgen).png"
scrot "$TMPFILE"
convert "$TMPFILE" -blur "8x8" "$TMPFILE"

# this should already happen in the i3 config, but just to be safe, we
# re-enable display sleeping explicitly.
xset dpms 300 600 900

i3lock -i "$TMPFILE"
rm "$TMPFILE"

